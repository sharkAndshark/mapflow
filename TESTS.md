# MapFlow 行为测试清单（可观测契约）

本文档仅记录系统对外可观测行为，用于约束快速演进中的行为一致性。

## 行为清单（当前已覆盖）

| 行为 | 触发方式 | 期望结果 |
| --- | --- | --- |
| 上传 GeoJSON 后列表出现新文件 | UI 上传 `.geojson` | 列表出现该文件，状态为“已上传” |
| 上传 Shapefile zip 后列表出现新文件 | UI 上传 `.zip` | 列表出现该文件，状态为“已上传” |
| 首次进入首页显示历史上传文件 | 首次打开首页 | 列表显示历史上传记录 |
| 上传后重启服务仍可见历史文件 | 上传完成后重启服务 | 列表仍显示之前上传的文件 |
| 上传不支持格式时提示失败 | 上传不支持的文件 | 显示失败提示 |
| 上传超过配置上限时提示失败 | 上传超限文件 | 显示失败提示 |
| Shapefile zip 缺关键文件时上传失败 | 上传缺关键文件的 zip | 显示失败提示 |
| 服务重启后残留 uploading 自动变 failed | 重启服务 | 历史上传显示为失败 |

## 行为清单（计划补充）
暂无

## 一致性约束
- 行为测试通过即代表用户层面的承诺仍成立
- README 中的“最小接口/存储约定”变更时，应同步更新本文档

## 测试注意事项
- 运行前端 e2e（`npm run test:e2e`）前请确保测试端口（默认 `3000`）未运行后端服务，否则会复用已有服务导致用例读取到非测试目录数据
- 如需避免端口冲突，可通过环境变量 `TEST_PORT` 指定测试端口：`TEST_PORT=9999 npm run test:e2e`
